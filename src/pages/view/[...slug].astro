---
import cfg from "../../../cfg.json";
import Layout from "../../layouts/Layout.astro";
import scraper from "../../../scraper.ts";
let slug = Astro.params.slug;

let title = slug.split("-episode")[0];
let videos, url, data, image, number, trytitle;
url = "/category/" + title;
videos = await scraper.getSources("/" + slug);
data = await scraper.get(url);
data.title = data.title.replace(/"/g, "");
image = await scraper.getImage(url);
number = slug.split("episode-")[1];
if (videos.length == 0) {
	data = await scraper.get(url);
	image = await scraper.getImage(url);
	trytitle = data.title;
	//replace all spaces with -
	trytitle = trytitle.replace(/\s+/g, "-");
	//replace all uppercase with lowercase
	trytitle = trytitle.toLowerCase();
	trytitle = trytitle + "-episode-" + number;
	// console.log("trytitle " + trytitle)
	videos = await scraper.getSources("/" + trytitle);
}
---

<Layout name={slug}>
	<span style="color:white">hello!</span>
</Layout>
